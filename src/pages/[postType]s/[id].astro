---
import { getCollection, render } from 'astro:content';
import ContentLayout from '../../layouts/ContentLayout.astro';
import TypographyToggle from '../../components/ui/TypographyToggle.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { processBlurb } from '../../lib/utils';

export async function getStaticPaths() {
	const posts = await getCollection('posts');
	return posts.map((post) => ({
		params: { id: post.id, postType: post.data.type },
		props: { post },
	}));
}

const { post } = Astro.props;
const { Content } = await render(post);

const blurb = post.data.blurb ? processBlurb(post.data.blurb) : '';
---

<BaseLayout title={post.data.title}>
	<div class="container mx-auto max-w-6xl">
		<main class="flex bg-red-200 dark:bg-gray-950 dark:text-gray-50">
			<aside class="w-64 border-r border-gray-200 bg-white">asd</aside>

			<div class="relative w-full bg-white">
				<div class="ml-16 py-8 pr-16">
					<article class="prose max-w-prose text-lg">
						<h1 class="mb-8 text-3xl font-semibold text-gray-900 dark:text-gray-50">
							{post.data.title}
						</h1>
						<Content />
					</article>
				</div>
			</div>

			<!-- Right aside -->
			<aside class="w-64 border-l border-gray-200 bg-white">
				<div class="p-4">
					<TypographyToggle />
					<div class="space-y-4">
						<div class="text-sm text-gray-600">
							<h4 class="mb-2 font-medium text-gray-900">Table of Contents</h4>
							<ul class="space-y-1">
								<li><a href="#" class="text-blue-600 hover:underline">Introduction</a></li>
								<li><a href="#" class="text-blue-600 hover:underline">Material Letters</a></li>
								<li><a href="#" class="text-blue-600 hover:underline">Digital Materiality</a></li>
							</ul>
						</div>
					</div>
				</div>
			</aside>
		</main>
	</div>
</BaseLayout>
