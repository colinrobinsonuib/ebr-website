---
import { getCollection, render } from 'astro:content';
import ContentLayout from '../../layouts/ContentLayout.astro';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { processBlurb } from '../../lib/utils';

export async function getStaticPaths() {
	const posts = await getCollection('posts');
	return posts.map((post) => ({
		params: { id: post.id, postType: post.data.type },
		props: { post },
	}));
}

const { post } = Astro.props;
const { Content } = await render(post);

const blurb = post.data.blurb ? processBlurb(post.data.blurb) : '';
---

<style>
	.marginnote-def {
		float: left;
		margin-left: -33.333333%; /* -w-1/3 equivalent */
		width: 25%; /* w-1/4 equivalent */
		clear: left;
		font-size: 0.875rem;
		line-height: 1.25rem;
		color: #6b7280;
		padding-right: 1rem;
		margin-bottom: 1rem;
	}
</style>
<BaseLayout title={post.data.title}>
	<main class="mx-auto flex max-w-7xl">
		<!-- Left aside - visible background column -->
		<aside class="min-h-screen w-64 border-r border-gray-200 bg-white">
			<div class="p-4">
				<h3 class="mb-4 text-sm font-semibold text-gray-900">Left Sidebar</h3>
				<p class="text-sm text-gray-600">
					This is where sidenotes will visually appear, but they're actually floated from the
					article content.
				</p>
			</div>
		</aside>

		<article class="relative w-[52rem] bg-white">
			<div class="ml-16 py-8 pr-16">
				<div class="prose prose-lg max-w-none text-xl">
					<!--<div class="prose prose-lg max-w-prose text-lg">-->
					<h1 class="mb-8 text-3xl font-semibold text-gray-900">{post.data.title}</h1>
					<Content />
				</div>
			</div>
		</article>

		<!-- Right aside -->
		<aside class="min-h-screen w-64 border-l border-gray-200 bg-white">
			<div class="p-4">
				<h3 class="mb-4 text-sm font-semibold text-gray-900">Right Sidebar</h3>
				<div class="space-y-4">
					<div class="text-sm text-gray-600">
						<h4 class="mb-2 font-medium text-gray-900">Table of Contents</h4>
						<ul class="space-y-1">
							<li><a href="#" class="text-blue-600 hover:underline">Introduction</a></li>
							<li><a href="#" class="text-blue-600 hover:underline">Material Letters</a></li>
							<li><a href="#" class="text-blue-600 hover:underline">Digital Materiality</a></li>
						</ul>
					</div>
				</div>
			</div>
		</aside>
	</main>
</BaseLayout>
